CREATE PROCEDURE [log].[WriteToErrorLog]
	@PROCESS_MESSAGE NVARCHAR(max),
	@ERROR_MESSAGE NVARCHAR(max)
AS
BEGIN
	SET NOCOUNT ON;

	BEGIN TRY
		BEGIN TRANSACTION

		INSERT INTO [log].[ErrorLog]
		(ProcessMessage,
		Errormessage)
	VALUES
		(@PROCESS_MESSAGE,
			@ERROR_MESSAGE)

		COMMIT TRANSACTION;
	END TRY

	BEGIN CATCH
		SET @ERROR_MESSAGE = ERROR_MESSAGE();
		SET @PROCESS_MESSAGE = 'SP: ' + OBJECT_SCHEMA_NAME(@@PROCID) + '.' + OBJECT_NAME(@@PROCID);
		PRINT @PROCESS_MESSAGE + ' => ' +  @ERROR_MESSAGE;
	END CATCH;

END;